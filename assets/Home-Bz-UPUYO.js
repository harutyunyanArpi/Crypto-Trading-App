import{i as v,h as j,a as y,S as h,j as t,r as g,u as C,b as f,L as S,B as k,c as R}from"./index-CFxpCuMh.js";import{Q as B,u as M,g as A}from"./cryptoService-BwlXPH0x.js";var D=class extends B{constructor(e,s){super(e,s)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(e){super.setOptions({...e,behavior:v()})}getOptimisticResult(e){return e.behavior=v(),super.getOptimisticResult(e)}fetchNextPage(e){return this.fetch({...e,meta:{fetchMore:{direction:"forward"}}})}fetchPreviousPage(e){return this.fetch({...e,meta:{fetchMore:{direction:"backward"}}})}createResult(e,s){var P,_;const{state:r}=e,n=super.createResult(e,s),{isFetching:a,isRefetching:o,isError:c,isRefetchError:u}=n,i=(_=(P=r.fetchMeta)==null?void 0:P.fetchMore)==null?void 0:_.direction,d=c&&i==="forward",l=a&&i==="forward",N=c&&i==="backward",b=a&&i==="backward";return{...n,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:y(s,r.data),hasPreviousPage:j(s,r.data),isFetchNextPageError:d,isFetchingNextPage:l,isFetchPreviousPageError:N,isFetchingPreviousPage:b,isRefetchError:u&&!d&&!N,isRefetching:o&&!l&&!b}}};function I(e,s){return M(e,D)}function O(e,s,r){return[...e].sort((n,a)=>{const o=isNaN(Number(n[s]))?String(n[s]).toLowerCase():Number(n[s]),c=isNaN(Number(a[s]))?String(a[s]).toLowerCase():Number(a[s]);return o<c?r==="asc"?-1:1:o>c?r==="asc"?1:-1:0})}const E={vs_currency:"usd",order:"market_cap_desc",per_page:10,page:1,sparkline:!1};function F(e){const s={...E,...e},r=I({queryKey:["crypto-assets",s],queryFn:async({pageParam:n=1})=>(await A({...s,page:n})).data,getNextPageParam:(n,a)=>n.length>0?a.length+1:void 0,initialPageParam:1});return{data:r.data,isLoading:r.isLoading,isFetchingNextPage:r.isFetchingNextPage,hasNextPage:r.hasNextPage,fetchNextPage:r.fetchNextPage,isError:r.isError,error:r.error}}const L="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='iso-8859-1'?%3e%3csvg%20fill='%23000000'%20height='800px'%20width='800px'%20version='1.1'%20id='Capa_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20viewBox='0%200%20490%20490'%20xml:space='preserve'%3e%3cpolygon%20points='245,456.701%20490,33.299%200,33.299%20'/%3e%3c/svg%3e",W="data:image/svg+xml,%3csvg%20fill='%23000000'%20height='800px'%20width='800px'%20version='1.1'%20id='Capa_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20viewBox='0%200%20490%20490'%20xml:space='preserve'%20transform='matrix(1,%200,%200,%201,%200,%200)rotate(180)'%3e%3cg%20id='SVGRepo_bgCarrier'%20stroke-width='0'/%3e%3cg%20id='SVGRepo_tracerCarrier'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cg%20id='SVGRepo_iconCarrier'%3e%3cpolygon%20points='245,456.701%20490,33.299%200,33.299%20'/%3e%3c/g%3e%3c/svg%3e",q="_sortable_1yf0c_1",$="_sortIcon_1yf0c_11",x={sortable:q,sortIcon:$},w=({field:e,label:s,sortField:r,sortDirection:n,onSort:a})=>{const o=r===e,c=o?n===h.Asc?"ascending":"descending":"none",u=i=>{(i.key==="Enter"||i.key===" ")&&(i.preventDefault(),a(e))};return t.jsx("th",{className:x.sortable,role:"button",tabIndex:0,"aria-sort":c,onClick:()=>a(e),onKeyDown:u,children:t.jsxs("span",{children:[s,o&&t.jsx("span",{children:n===h.Asc?t.jsx("img",{src:W,alt:"Sort ascending",className:x.sortIcon}):t.jsx("img",{src:L,alt:"Sort descending",className:x.sortIcon})})]})})},Q="_menuWrapper_18d88_1",V="_menuButton_18d88_6",T="_menuDropdown_18d88_14",G="_menuItem_18d88_26",m={menuWrapper:Q,menuButton:V,menuDropdown:T,menuItem:G},K=({actions:e})=>{const[s,r]=g.useState(!1),n=g.useRef(null);C(n,()=>r(!1));const a=()=>r(o=>!o);return t.jsxs("div",{className:m.menuWrapper,ref:n,children:[t.jsx("button",{onClick:a,className:m.menuButton,"aria-label":"Open actions menu",children:"â‹®"}),s&&t.jsx("div",{className:m.menuDropdown,children:e.map((o,c)=>t.jsx("button",{onClick:()=>{o.onClick(),r(!1)},className:m.menuItem,type:"button",children:o.label},c))})]})},U="_assetName_pojng_1",H={assetName:U},Y=({asset:e})=>{var n;const s=a=>{alert(`Buying ${a.name}`)},r=a=>{alert(`Selling ${a.name}`)};return t.jsxs("tr",{children:[t.jsx("td",{children:t.jsxs("div",{className:H.assetName,children:[t.jsx("img",{src:e.image,alt:`${e.name} logo`}),t.jsx("span",{children:e.name})]})}),t.jsxs("td",{children:["$",(n=e.current_price)==null?void 0:n.toLocaleString()]}),t.jsx("td",{className:"flex-center",children:t.jsx(K,{actions:[{label:"Buy",onClick:()=>s(e)},{label:"Sell",onClick:()=>r(e)}]})})]})},z="_tableWrapper_m69q8_1",J="_table_m69q8_1",X="_loadMore_m69q8_32",Z="_noDataContainer_m69q8_47",p={tableWrapper:z,table:J,loadMore:X,noDataContainer:Z},ee=({assets:e,isLoading:s,hasNextPage:r,isFetchingNextPage:n,fetchNextPage:a,sortField:o,sortDirection:c,setSortField:u,setSortDirection:i})=>{const d=l=>{o===l?i(c===h.Asc?h.Desc:h.Asc):(u(l),i(h.Asc))};return t.jsxs("div",{className:p.tableWrapper,children:[t.jsxs("table",{className:p.table,children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx(w,{field:f.Name,label:"Name",sortField:o,sortDirection:c,onSort:d}),t.jsx(w,{field:f.Price,label:"Price (USD)",sortField:o,sortDirection:c,onSort:d}),t.jsx("th",{children:t.jsx("div",{className:"flex-center",children:"Buy/Sell"})})]})}),t.jsx("tbody",{children:s?t.jsx("tr",{children:t.jsx("td",{colSpan:3,children:t.jsx(S,{})})}):e.length===0?t.jsx("tr",{children:t.jsx("td",{colSpan:3,className:p.noDataContainer,children:"No data available."})}):e.map(l=>t.jsx(Y,{asset:l},l.id))})]}),r&&t.jsx(k,{variant:R.PRIMARY,className:p.loadMore,onClick:a,disabled:n,children:n?"Loading...":"Show More"})]})},ne=()=>{const{data:e,isFetchingNextPage:s,fetchNextPage:r,hasNextPage:n,isLoading:a}=F(),[o,c]=g.useState(f.Name),[u,i]=g.useState(h.Asc),d=g.useMemo(()=>(e==null?void 0:e.pages.flat())??[],[e]),l=g.useMemo(()=>O(d,o,u),[d,o,u]);return t.jsx(ee,{assets:l,isLoading:a,isFetchingNextPage:s,fetchNextPage:r,hasNextPage:n,sortField:o,sortDirection:u,setSortField:c,setSortDirection:i})};export{ne as default};
