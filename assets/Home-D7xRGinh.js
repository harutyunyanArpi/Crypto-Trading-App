import{i as _,h as y,a as N,S as h,j as t,r as g,u as S,b as P,L as C,B as k,c as R}from"./index-BQffJXAw.js";import{Q as B,u as A,g as M}from"./cryptoService-CiTwE95C.js";var I=class extends B{constructor(e,r){super(e,r)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(e){super.setOptions({...e,behavior:_()})}getOptimisticResult(e){return e.behavior=_(),super.getOptimisticResult(e)}fetchNextPage(e){return this.fetch({...e,meta:{fetchMore:{direction:"forward"}}})}fetchPreviousPage(e){return this.fetch({...e,meta:{fetchMore:{direction:"backward"}}})}createResult(e,r){var v,w;const{state:s}=e,n=super.createResult(e,r),{isFetching:a,isRefetching:o,isError:i,isRefetchError:d}=n,c=(w=(v=s.fetchMeta)==null?void 0:v.fetchMore)==null?void 0:w.direction,u=i&&c==="forward",l=a&&c==="forward",p=i&&c==="backward",b=a&&c==="backward";return{...n,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:N(r,s.data),hasPreviousPage:y(r,s.data),isFetchNextPageError:u,isFetchingNextPage:l,isFetchPreviousPageError:p,isFetchingPreviousPage:b,isRefetchError:d&&!u&&!p,isRefetching:o&&!l&&!b}}};function O(e,r){return A(e,I)}function D(e,r,s){return[...e].sort((n,a)=>{var d,c,u,l;const o=((c=(d=String(n[r])).toLowerCase)==null?void 0:c.call(d))??n[r],i=((l=(u=String(a[r])).toLowerCase)==null?void 0:l.call(u))??a[r];return o<i?s==="asc"?-1:1:o>i?s==="asc"?1:-1:0})}const E={vs_currency:"usd",order:"market_cap_desc",per_page:10,page:1,sparkline:!1};function F(e){const r={...E,...e},s=O({queryKey:["crypto-assets",r],queryFn:async({pageParam:n=1})=>await M({...r,page:n}),getNextPageParam:(n,a)=>n.length>0?a.length+1:void 0,initialPageParam:1});return{data:s.data,isLoading:s.isLoading,isFetchingNextPage:s.isFetchingNextPage,hasNextPage:s.hasNextPage,fetchNextPage:s.fetchNextPage,isError:s.isError,error:s.error}}const L="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='iso-8859-1'?%3e%3csvg%20fill='%23000000'%20height='800px'%20width='800px'%20version='1.1'%20id='Capa_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20viewBox='0%200%20490%20490'%20xml:space='preserve'%3e%3cpolygon%20points='245,456.701%20490,33.299%200,33.299%20'/%3e%3c/svg%3e",W="data:image/svg+xml,%3csvg%20fill='%23000000'%20height='800px'%20width='800px'%20version='1.1'%20id='Capa_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20viewBox='0%200%20490%20490'%20xml:space='preserve'%20transform='matrix(1,%200,%200,%201,%200,%200)rotate(180)'%3e%3cg%20id='SVGRepo_bgCarrier'%20stroke-width='0'/%3e%3cg%20id='SVGRepo_tracerCarrier'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cg%20id='SVGRepo_iconCarrier'%3e%3cpolygon%20points='245,456.701%20490,33.299%200,33.299%20'/%3e%3c/g%3e%3c/svg%3e",$="_sortable_1yf0c_1",Q="_sortIcon_1yf0c_11",x={sortable:$,sortIcon:Q},j=({field:e,label:r,sortField:s,sortDirection:n,onSort:a})=>{const o=s===e,i=o?n===h.Asc?"ascending":"descending":"none",d=c=>{(c.key==="Enter"||c.key===" ")&&(c.preventDefault(),a(e))};return t.jsx("th",{className:x.sortable,role:"button",tabIndex:0,"aria-sort":i,onClick:()=>a(e),onKeyDown:d,children:t.jsxs("span",{children:[r,o&&t.jsx("span",{children:n===h.Asc?t.jsx("img",{src:W,alt:"Sort ascending",className:x.sortIcon}):t.jsx("img",{src:L,alt:"Sort descending",className:x.sortIcon})})]})})},V="_menuWrapper_18d88_1",T="_menuButton_18d88_6",q="_menuDropdown_18d88_14",G="_menuItem_18d88_26",m={menuWrapper:V,menuButton:T,menuDropdown:q,menuItem:G},K=({actions:e})=>{const[r,s]=g.useState(!1),n=g.useRef(null);S(n,()=>s(!1));const a=()=>s(o=>!o);return t.jsxs("div",{className:m.menuWrapper,ref:n,children:[t.jsx("button",{onClick:a,className:m.menuButton,"aria-label":"Open actions menu",children:"â‹®"}),r&&t.jsx("div",{className:m.menuDropdown,children:e.map((o,i)=>t.jsx("button",{onClick:()=>{o.onClick(),s(!1)},className:m.menuItem,type:"button",children:o.label},i))})]})},U="_assetName_pojng_1",H={assetName:U},Y=({asset:e})=>{var n;const r=a=>{alert(`Buying ${a.name}`)},s=a=>{alert(`Selling ${a.name}`)};return t.jsxs("tr",{children:[t.jsx("td",{children:t.jsxs("div",{className:H.assetName,children:[t.jsx("img",{src:e.image,alt:`${e.name} logo`}),t.jsx("span",{children:e.name})]})}),t.jsxs("td",{children:["$",(n=e.current_price)==null?void 0:n.toLocaleString()]}),t.jsx("td",{children:t.jsx(K,{actions:[{label:"Buy",onClick:()=>r(e)},{label:"Sell",onClick:()=>s(e)}]})})]})},z="_tableWrapper_x78aw_1",J="_table_x78aw_1",X="_loadMore_x78aw_32",f={tableWrapper:z,table:J,loadMore:X},Z=({assets:e,isLoading:r,hasNextPage:s,isFetchingNextPage:n,fetchNextPage:a,sortField:o,sortDirection:i,setSortField:d,setSortDirection:c})=>{const u=l=>{o===l?c(i===h.Asc?h.Desc:h.Asc):(d(l),c(h.Asc))};return t.jsxs("div",{className:f.tableWrapper,children:[t.jsxs("table",{className:f.table,children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx(j,{field:P.Name,label:"Name",sortField:o,sortDirection:i,onSort:u}),t.jsx(j,{field:P.Price,label:"Price (USD)",sortField:o,sortDirection:i,onSort:u}),t.jsx("th",{children:"Buy/Sell"})]})}),t.jsx("tbody",{children:r?t.jsx("tr",{children:t.jsx("td",{colSpan:3,children:t.jsx(C,{})})}):e.length===0?t.jsx("tr",{children:t.jsx("td",{colSpan:3,children:"No data available."})}):e.map(l=>t.jsx(Y,{asset:l},l.id))})]}),s&&t.jsx(k,{variant:R.PRIMARY,className:f.loadMore,onClick:a,disabled:n,children:n?"Loading...":"Show More"})]})},re=()=>{const{data:e,isFetchingNextPage:r,fetchNextPage:s,hasNextPage:n,isLoading:a}=F(),[o,i]=g.useState(P.Name),[d,c]=g.useState(h.Asc),u=g.useMemo(()=>(e==null?void 0:e.pages.flat())??[],[e]),l=g.useMemo(()=>{const p=d===h.Asc?"asc":"desc";return D(u,o,p)},[u,o,d]);return t.jsx(Z,{assets:l,isLoading:a,isFetchingNextPage:r,fetchNextPage:s,hasNextPage:n,sortField:o,sortDirection:d,setSortField:i,setSortDirection:c})};export{re as default};
